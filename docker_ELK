sudo yum -y install open-vm-tools nano git wget gcc gcc-c++ 
sudo yum -y install zlib zlib-devel 
sudo yum -y install libffi-devel 
sudo yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
sudo subscription-manager repos --enable "rhel-*-optional-rpms" --enable "rhel-*-extras-rpms"

curl 'https://setup.ius.io/' -o setup-ius.sh
sh setup-ius.sh
sudo yum --enablerepo=ius info python36u
sudo yum --enablerepo=ius install python36u -y

sudo yum -y install python-wheel python-pip

pip install --upgrade pip
pip install virtualenv
pip install pyopenssl
pip install docker-compose

sudo sed -i 's/# include/include/' /etc/nanorc
sudo sed -i "\$aset const" /etc/nanorc

sudo firewall-cmd --permanent --add-port=9200/tcp
sudo firewall-cmd --permanent --add-port=9300/tcp
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --permanent --add-port=5601/tcp

sudo wget https://download.docker.com/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker.repo
sudo yum -y install docker-ce

sudo systemctl start docker
sudo systemctl enable docker

cd /usr/share
sudo git clone https://github.com/elastic/stack-docker.git
cd stack-docker

sudo sed -i 's/6.3.0/6.4.1/' .env
sudo sed -i "\$aPWD=/usr/share/stack-docker" .env
sudo sed -i 's/1.21.2/1.22.0/' setup.yml

make

sudo /usr/local/bin/docker-compose -f setup.yml up
